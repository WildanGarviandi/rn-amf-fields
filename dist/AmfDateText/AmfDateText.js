Object.defineProperty(exports,"__esModule",{value:true});var _jsxFileName='src/AmfDateText/AmfDateText.js';var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _reactNative=require('react-native');var _AmfDropdown=require('../AmfDropdown/AmfDropdown');var _AmfDropdown2=_interopRequireDefault(_AmfDropdown);var _moment=require('moment');var _moment2=_interopRequireDefault(_moment);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var AmfDateText=function(_Component){_inherits(AmfDateText,_Component);function AmfDateText(props){_classCallCheck(this,AmfDateText);var _this=_possibleConstructorReturn(this,(AmfDateText.__proto__||Object.getPrototypeOf(AmfDateText)).call(this,props));_this.createDayOptions=function(){var opt=[];for(var i=1;i<=31;i++){var str=i.toString();var strPadded=str.length===1?'0'+str:str;opt.push({label:strPadded,value:strPadded});}return opt;};_this.createMonthOptions=function(){var opt=[];for(var i=1;i<=12;i++){var str=i.toString();var strPadded=str.length===1?'0'+str:str;opt.push({label:monthNames[i-1],value:strPadded});}return opt;};_this.createYearOptions=function(){var opt=[];for(var i=1940;i<=2017;i++){var str=i.toString();opt.push({label:str,value:str});}return opt;};_this.inputValid=function(){var _this$props=_this.props,validation=_this$props.validation,label=_this$props.label;if(!validation)return{status:true};if(_this.props.value===null||_this.props.value===undefined)return{status:true};if(validation.required){if(_this.props.value==='')return{status:false,message:label+' tidak boleh kosong'};}return{status:true};};_this.validate=function(){var validationObject=_this.inputValid();_this.setState({valid:validationObject.status,errorMessage:validationObject.message});};var initialState={valid:false,errorMessage:''};if(_this.props.value!=''&&_this.props.value!=null&&_this.props.value!=undefined){console.log(_this.props.value);var temp=_this.props.value.split('-');_this.state=_extends({},initialState,{day:temp[2],month:temp[1],year:temp[0]});}else{_this.state=_extends({},initialState,{day:'',month:'',year:''});}_this.dayOptions=_this.createDayOptions();_this.monthOptions=_this.createMonthOptions();_this.yearOptions=_this.createYearOptions();return _this;}_createClass(AmfDateText,[{key:'componentDidMount',value:function componentDidMount(){this.validate();}},{key:'componentDidUpdate',value:function componentDidUpdate(prevProps){if(this.props.value!==prevProps.value){this.validate();}}},{key:'updateDate',value:function updateDate(type,val){var date=void 0;var year=type=='year'?val:this.state.year;var month=type=='month'?val:this.state.month;var day=type=='day'?val:this.state.day;this.setState({day:day,month:month,year:year});if(day==''||month==''||year=='')return'incomplete';do{date=(0,_moment2.default)(year+'-'+month+'-'+day,'YYYY-MM-DD').format('YYYY-MM-DD');if(date=='Invalid date'){var dayInt=parseInt(day);day=(dayInt-1).toString().padStart(2,'0');}}while(date=='Invalid date');return date;}},{key:'render',value:function render(){var _this2=this;var dayObject=this.dayOptions.find(function(item){return item.value==_this2.state.day;});var monthObject=this.monthOptions.find(function(item){return item.value==_this2.state.month;});var yearObject=this.yearOptions.find(function(item){return item.value==_this2.state.year;});var validationStyle={};var validationText=void 0;if(!this.state.valid){validationStyle={borderColor:'red',borderWidth:1};validationText=_react2.default.createElement(_reactNative.Text,{style:style.errorText,__source:{fileName:_jsxFileName,lineNumber:131}},this.state.errorMessage);}return _react2.default.createElement(_reactNative.View,{__source:{fileName:_jsxFileName,lineNumber:135}},_react2.default.createElement(_reactNative.View,{style:this.props.layout==='horizontal'?style.container:null,__source:{fileName:_jsxFileName,lineNumber:136}},_react2.default.createElement(_reactNative.Text,{style:style.label,__source:{fileName:_jsxFileName,lineNumber:137}},this.props.label),_react2.default.createElement(_reactNative.View,{style:[style.pickerContainer,validationStyle],__source:{fileName:_jsxFileName,lineNumber:138}},_react2.default.createElement(_AmfDropdown2.default,{layout:'horizontal',item:this.dayOptions,value:dayObject?dayObject.value:null,onSelect:function onSelect(val){var temp=val;date=_this2.updateDate('day',temp);if(date!='incomplete')_this2.props.onChange(date);},selector:_react2.default.createElement(_reactNative.View,{style:[style.selector,{width:50}],__source:{fileName:_jsxFileName,lineNumber:149}},_react2.default.createElement(_reactNative.Text,{style:style.textInput,__source:{fileName:_jsxFileName,lineNumber:150}},dayObject?dayObject.label:'DD')),__source:{fileName:_jsxFileName,lineNumber:139}}),_react2.default.createElement(_reactNative.Text,{style:style.dividerText,__source:{fileName:_jsxFileName,lineNumber:154}},'/'),_react2.default.createElement(_AmfDropdown2.default,{layout:'horizontal',item:this.monthOptions,value:monthObject?monthObject.value:null,onSelect:function onSelect(val){var temp=val;date=_this2.updateDate('month',temp);if(date!='incomplete')_this2.props.onChange(date);},selector:_react2.default.createElement(_reactNative.View,{style:[style.selector,{width:50}],__source:{fileName:_jsxFileName,lineNumber:165}},_react2.default.createElement(_reactNative.Text,{style:style.textInput,__source:{fileName:_jsxFileName,lineNumber:166}},monthObject?monthObject.label:'MM')),__source:{fileName:_jsxFileName,lineNumber:155}}),_react2.default.createElement(_reactNative.Text,{style:style.dividerText,__source:{fileName:_jsxFileName,lineNumber:170}},'/'),_react2.default.createElement(_AmfDropdown2.default,{layout:'horizontal',item:this.yearOptions,value:yearObject?yearObject.value:null,onSelect:function onSelect(val){var temp=val;date=_this2.updateDate('year',temp);if(date!='incomplete')_this2.props.onChange(date);},selector:_react2.default.createElement(_reactNative.View,{style:[style.selector,{width:70}],__source:{fileName:_jsxFileName,lineNumber:181}},_react2.default.createElement(_reactNative.Text,{style:style.textInput,__source:{fileName:_jsxFileName,lineNumber:182}},yearObject?yearObject.label:'YYYY')),__source:{fileName:_jsxFileName,lineNumber:171}}))),validationText);}}]);return AmfDateText;}(_react.Component);var monthNames=['Jan','Feb','Mar','Apr','Mei','Jun','Jul','Ags','Sep','Okt','Nov','Des'];var style=_reactNative.StyleSheet.create({container:{flexDirection:'row',alignItems:'center'},dividerText:{fontSize:20,color:'#9B9B9B',marginHorizontal:4},errorText:{color:'red',margin:4,marginBottom:0},label:{color:'#454545',marginRight:16},pickerContainer:{flexDirection:'row',alignItems:'center',padding:8},selector:{flexDirection:'row',justifyContent:'center',alignItems:'center',height:30},textInput:{textAlign:'center'}});AmfDateText.defaultProps={layout:'vertical'};AmfDateText.propTypes={label:_propTypes2.default.string,layout:_propTypes2.default.oneOf(['vertical','horizontal']),onChange:_propTypes2.default.func.isRequired,value:_propTypes2.default.string};exports.default=AmfDateText;